import{f as B,g as S,i as W,h as $,j as se,k as ne,r as R,l as re,m as ae,n as P,o as f,w as v,p as D,q as r,s as V,b as h,P as ie,v as O,x as le,y as Z,C as de,z as J,A as ce,d as L,t as z,B as ue,D as pe,E as fe,F as ee,G as ge,H as me,I as q,J as G,K as he,L as ve,M as Q,N as be,O as X,Q as A,c as T,R as F,S as U,T as M,U as _e,a as d,V as xe,W as ye,X as we}from"./Dzi8umfP.js";import{U as ke}from"./DW5m1xOE.js";import{_ as Ce,a as Pe,b as $e,u as Te,c as De}from"./BNMRaVlq.js";import{u as Be}from"./UpvGFBYd.js";import{_ as Oe,f as H}from"./C-dKi4r0.js";import{$ as K,a as j,b as E}from"./D6ATwwEs.js";import{u as Ee}from"./4z8zRpvv.js";import{c as ze,a as Fe}from"./Bk2ha_xb.js";import"./BsYNtWxF.js";const te="tooltip.open",[N,Se]=ae("TooltipRoot"),Ae=B({__name:"TooltipRoot",props:{defaultOpen:{type:Boolean,default:!1},open:{type:Boolean,default:void 0},delayDuration:{default:void 0},disableHoverableContent:{type:Boolean,default:void 0},disableClosingTrigger:{type:Boolean,default:void 0},disabled:{type:Boolean,default:void 0},ignoreNonKeyboardFocus:{type:Boolean,default:void 0}},emits:["update:open"],setup(x,{emit:m}){const s=x,y=m;S();const i=W(),C=$(()=>s.disableHoverableContent??i.disableHoverableContent.value),b=$(()=>s.disableClosingTrigger??i.disableClosingTrigger.value),w=$(()=>s.disabled??i.disabled.value),_=$(()=>s.delayDuration??i.delayDuration.value),e=$(()=>s.ignoreNonKeyboardFocus??i.ignoreNonKeyboardFocus.value),o=se(s,"open",y,{defaultValue:s.defaultOpen,passive:s.open===void 0});ne(o,c=>{i.onClose&&(c?(i.onOpen(),document.dispatchEvent(new CustomEvent(te))):i.onClose())});const t=R(!1),a=R(),l=$(()=>o.value?t.value?"delayed-open":"instant-open":"closed"),{start:u,stop:k}=re(()=>{t.value=!0,o.value=!0},_,{immediate:!1});function n(){k(),t.value=!1,o.value=!0}function p(){k(),o.value=!1}function g(){u()}return Se({contentId:"",open:o,stateAttribute:l,trigger:a,onTriggerChange(c){a.value=c},onTriggerEnter(){i.isOpenDelayed.value?g():n()},onTriggerLeave(){C.value?p():k()},onOpen:n,onClose:p,disableHoverableContent:C,disableClosingTrigger:b,disabled:w,ignoreNonKeyboardFocus:e}),(c,I)=>(f(),P(r(Ce),null,{default:v(()=>[D(c.$slots,"default",{open:r(o)})]),_:3}))}}),He=B({__name:"TooltipTrigger",props:{reference:{},asChild:{type:Boolean},as:{default:"button"}},setup(x){const m=x,s=N(),y=W();s.contentId||(s.contentId=Be(void 0,"reka-tooltip-content"));const{forwardRef:i,currentElement:C}=S(),b=R(!1),w=R(!1),_=$(()=>s.disabled.value?{}:{click:k,focus:l,pointermove:t,pointerleave:a,pointerdown:o,blur:u});V(()=>{s.onTriggerChange(C.value)});function e(){setTimeout(()=>{b.value=!1},1)}function o(){b.value=!0,document.addEventListener("pointerup",e,{once:!0})}function t(n){n.pointerType!=="touch"&&!w.value&&!y.isPointerInTransitRef.value&&(s.onTriggerEnter(),w.value=!0)}function a(){s.onTriggerLeave(),w.value=!1}function l(n){var p,g;b.value||s.ignoreNonKeyboardFocus.value&&!((g=(p=n.target).matches)!=null&&g.call(p,":focus-visible"))||s.onOpen()}function u(){s.onClose()}function k(){s.disableClosingTrigger.value||s.onClose()}return(n,p)=>(f(),P(r(Pe),{"as-child":"",reference:n.reference},{default:v(()=>[h(r(ie),O({ref:r(i),"aria-describedby":r(s).open.value?r(s).contentId:void 0,"data-state":r(s).stateAttribute.value,as:n.as,"as-child":m.asChild,"data-grace-area-trigger":""},le(_.value)),{default:v(()=>[D(n.$slots,"default")]),_:3},16,["aria-describedby","data-state","as","as-child"])]),_:3},8,["reference"]))}}),oe=B({__name:"TooltipContentImpl",props:{ariaLabel:{},asChild:{type:Boolean},as:{},side:{default:"top"},sideOffset:{default:0},align:{default:"center"},alignOffset:{},avoidCollisions:{type:Boolean,default:!0},collisionBoundary:{default:()=>[]},collisionPadding:{default:0},arrowPadding:{default:0},sticky:{default:"partial"},hideWhenDetached:{type:Boolean,default:!1},positionStrategy:{},updatePositionStrategy:{}},emits:["escapeKeyDown","pointerDownOutside"],setup(x,{emit:m}){const s=x,y=m,i=N(),{forwardRef:C}=S(),b=Z(),w=$(()=>{var o;return(o=b.default)==null?void 0:o.call(b,{})}),_=$(()=>{var a;if(s.ariaLabel)return s.ariaLabel;let o="";function t(l){typeof l.children=="string"&&l.type!==de?o+=l.children:Array.isArray(l.children)&&l.children.forEach(u=>t(u))}return(a=w.value)==null||a.forEach(l=>t(l)),o}),e=$(()=>{const{ariaLabel:o,...t}=s;return t});return V(()=>{J(window,"scroll",o=>{const t=o.target;t!=null&&t.contains(i.trigger.value)&&i.onClose()}),J(window,te,i.onClose)}),(o,t)=>(f(),P(r(pe),{"as-child":"","disable-outside-pointer-events":!1,onEscapeKeyDown:t[0]||(t[0]=a=>y("escapeKeyDown",a)),onPointerDownOutside:t[1]||(t[1]=a=>{var l;r(i).disableClosingTrigger.value&&((l=r(i).trigger.value)!=null&&l.contains(a.target))&&a.preventDefault(),y("pointerDownOutside",a)}),onFocusOutside:t[2]||(t[2]=ue(()=>{},["prevent"])),onDismiss:t[3]||(t[3]=a=>r(i).onClose())},{default:v(()=>[h(r($e),O({ref:r(C),"data-state":r(i).stateAttribute.value},{...o.$attrs,...e.value},{style:{"--reka-tooltip-content-transform-origin":"var(--reka-popper-transform-origin)","--reka-tooltip-content-available-width":"var(--reka-popper-available-width)","--reka-tooltip-content-available-height":"var(--reka-popper-available-height)","--reka-tooltip-trigger-width":"var(--reka-popper-anchor-width)","--reka-tooltip-trigger-height":"var(--reka-popper-anchor-height)"}}),{default:v(()=>[D(o.$slots,"default"),h(r(ce),{id:r(i).contentId,role:"tooltip"},{default:v(()=>[L(z(_.value),1)]),_:1},8,["id"])]),_:3},16,["data-state"])]),_:3}))}}),Le=B({__name:"TooltipContentHoverable",props:{ariaLabel:{},asChild:{type:Boolean},as:{},side:{},sideOffset:{},align:{},alignOffset:{},avoidCollisions:{type:Boolean},collisionBoundary:{},collisionPadding:{},arrowPadding:{},sticky:{},hideWhenDetached:{type:Boolean},positionStrategy:{},updatePositionStrategy:{}},setup(x){const s=fe(x),{forwardRef:y,currentElement:i}=S(),{trigger:C,onClose:b}=N(),w=W(),{isPointerInTransit:_,onPointerExit:e}=Te(C,i);return w.isPointerInTransitRef=_,e(()=>{b()}),(o,t)=>(f(),P(oe,O({ref:r(y)},r(s)),{default:v(()=>[D(o.$slots,"default")]),_:3},16))}}),Re=B({__name:"TooltipContent",props:{forceMount:{type:Boolean},ariaLabel:{},asChild:{type:Boolean},as:{},side:{default:"top"},sideOffset:{},align:{},alignOffset:{},avoidCollisions:{type:Boolean},collisionBoundary:{},collisionPadding:{},arrowPadding:{},sticky:{},hideWhenDetached:{type:Boolean},positionStrategy:{},updatePositionStrategy:{}},emits:["escapeKeyDown","pointerDownOutside"],setup(x,{emit:m}){const s=x,y=m,i=N(),C=ee(s,y),{forwardRef:b}=S();return(w,_)=>(f(),P(r(me),{present:w.forceMount||r(i).open.value},{default:v(()=>[(f(),P(ge(r(i).disableHoverableContent.value?oe:Le),O({ref:r(b)},r(C)),{default:v(()=>[D(w.$slots,"default")]),_:3},16))]),_:3},8,["present"]))}}),Ne=B({__name:"TooltipArrow",props:{width:{default:10},height:{default:5},asChild:{type:Boolean},as:{default:"svg"}},setup(x){const m=x;return S(),(s,y)=>(f(),P(r(De),q(G(m)),{default:v(()=>[D(s.$slots,"default")]),_:3},16))}}),Ie=B({__name:"TooltipPortal",props:{to:{},disabled:{type:Boolean},defer:{type:Boolean},forceMount:{type:Boolean}},setup(x){const m=x;return(s,y)=>(f(),P(r(he),q(G(m)),{default:v(()=>[D(s.$slots,"default")]),_:3},16))}}),Ke={slots:{content:"flex items-center gap-1 bg-(--ui-bg) text-(--ui-text-highlighted) shadow-sm rounded-(--ui-radius) ring ring-(--ui-border) h-6 px-2 py-1 text-xs select-none data-[state=delayed-open]:animate-[scale-in_100ms_ease-out] data-[state=closed]:animate-[scale-out_100ms_ease-in] pointer-events-auto",arrow:"fill-(--ui-border)",text:"truncate",kbds:"hidden lg:inline-flex items-center shrink-0 gap-0.5 before:content-['·'] before:me-0.5",kbdsSize:"sm"}},je=_e;var Y;const Ue=X({extend:X(Ke),...((Y=je.ui)==null?void 0:Y.tooltip)||{}}),Me=B({__name:"Tooltip",props:{text:{},kbds:{},content:{},arrow:{type:[Boolean,Object]},portal:{type:Boolean,default:!0},class:{},ui:{},defaultOpen:{type:Boolean},open:{type:Boolean},delayDuration:{},disableHoverableContent:{type:Boolean},disableClosingTrigger:{type:Boolean},disabled:{type:Boolean},ignoreNonKeyboardFocus:{type:Boolean}},emits:["update:open"],setup(x,{emit:m}){const s=x,y=m,i=Z(),C=ee(ve(s,"defaultOpen","open","delayDuration","disableHoverableContent","disableClosingTrigger","disabled","ignoreNonKeyboardFocus"),y),b=Q(()=>be(s.content,{side:"bottom",sideOffset:8,collisionPadding:8})),w=Q(()=>s.arrow),_=$(()=>Ue({side:b.value.side}));return(e,o)=>(f(),P(r(Ae),q(G(r(C))),{default:v(({open:t})=>[i.default?(f(),P(r(He),O({key:0},e.$attrs,{"as-child":"",class:s.class}),{default:v(()=>[D(e.$slots,"default",{open:t})]),_:2},1040,["class"])):A("",!0),h(r(Ie),{disabled:!e.portal},{default:v(()=>{var a;return[h(r(Re),O(b.value,{class:_.value.content({class:[!i.default&&s.class,(a=s.ui)==null?void 0:a.content]})}),{default:v(()=>{var l;return[D(e.$slots,"content",{},()=>{var u,k,n;return[e.text?(f(),T("span",{key:0,class:F(_.value.text({class:(u=s.ui)==null?void 0:u.text}))},z(e.text),3)):A("",!0),(k=e.kbds)!=null&&k.length?(f(),T("span",{key:1,class:F(_.value.kbds({class:(n=s.ui)==null?void 0:n.kbds}))},[(f(!0),T(U,null,M(e.kbds,(p,g)=>{var c;return f(),P(ke,O({key:g,size:((c=s.ui)==null?void 0:c.kbdsSize)||_.value.kbdsSize(),ref_for:!0},typeof p=="string"?{value:p}:p),null,16,["size"])}),128))],2)):A("",!0)]}),e.arrow?(f(),P(r(Ne),O({key:0},w.value,{class:_.value.arrow({class:(l=s.ui)==null?void 0:l.arrow})}),null,16,["class"])):A("",!0)]}),_:3},16,["class"])]}),_:3},8,["disabled"])]),_:3},16))}}),We=Object.assign(Me,{__name:"UTooltip"}),Ve={class:"min-h-screen p-8"},qe={class:"max-w-6xl mx-auto"},Ge={key:0,class:"text-center py-6"},Je={key:1,class:"bg-red-50 border border-red-200 text-red-700 p-4 rounded-lg mb-6"},Qe={class:"flex items-center"},Xe={key:2,class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ye={class:"w-full flex justify-center items-center rounded-2xl shadow-sm bg-neutral-800/20 dark:bg-neutral-100/10 backdrop-blur-md ring-2 ring-neutral-100/20 dark:ring-neutral-700/20 overflow-hidden h-full"},Ze={class:"w-full rounded-2xl shadow-sm bg-neutral-800/20 dark:bg-neutral-100/10 backdrop-blur-sm ring-2 ring-neutral-100/20 dark:ring-neutral-700/20 overflow-hidden h-full"},et={class:"flex justify-center items-center w-full mt-8"},tt={class:"mt-2 p-6"},ot={class:"flex justify-between items-start"},st={class:"flex items-center gap-2"},nt={class:"text-xl font-medium text-neutral-800 dark:text-neutral-100"},rt={class:"text-neutral-500 dark:text-neutral-400 mt-1 flex items-center gap-4"},at={class:"flex items-center"},it={class:"flex items-center"},lt={key:0,class:"flex flex-wrap gap-2 justify-end"},dt={class:"flex items-center"},ct={class:"hidden sm:inline"},ut={class:"mt-4 grid grid-cols-2 gap-2"},pt={class:"flex items-center gap-2 p-2 rounded-lg brackdrop-blur-sm bg-neutral-50/30 dark:bg-neutral-950/30 ring-1 ring-neutral-400/30 dark:ring-neutral-700/30"},ft={class:"flex items-center gap-2 p-2 rounded-lg brackdrop-blur-sm bg-neutral-50/30 dark:bg-neutral-950/30 ring-1 ring-neutral-400/30 dark:ring-neutral-700/30"},gt={class:"flex items-center gap-2 p-2 rounded-lg brackdrop-blur-sm bg-neutral-50/30 dark:bg-neutral-950/30 ring-1 ring-neutral-400/30 dark:ring-neutral-700/30"},mt={class:"flex items-center gap-2 p-2 rounded-lg brackdrop-blur-sm bg-neutral-50/30 dark:bg-neutral-950/30 ring-1 ring-neutral-400/30 dark:ring-neutral-700/30"},Pt=B({__name:"index",setup(x){const m=Ee();async function s(){try{await m.fetchAnimals()}catch(e){console.error("Failed to initialize animal store:",e)}}V(()=>{s()});const y=e=>ze(e),i=e=>Fe(e),C=e=>{if(!e||!e.end)return!0;const o=K(j());try{return E(e.end).compare(o)<=0}catch(t){return console.error("Error checking protection expiration:",t),!0}},b=e=>{var a,l;if(!((a=e.food)!=null&&a.length))return"empty";const o=e.food.find(u=>u.state==="stock"),t=e.food.find(u=>u.state==="open");return!o&&t&&((l=H(t))==null?void 0:l.percentage)>=70?"low":"ok"},w=e=>{var t;if(!e.weight||!((t=e.weightHistory)!=null&&t.length))return!1;const o=K(j());try{const a=[...e.weightHistory].map(u=>({...u,parsedDate:typeof u.date=="string"?E(u.date):u.date})).sort((u,k)=>!u.parsedDate||!k.parsedDate?0:u.parsedDate.compare(k.parsedDate)>0?1:-1),l=a[a.length-1];if(l&&l.parsedDate)return o.compare(l.parsedDate)<60}catch(a){console.error("Error processing weight history:",a)}return!1},_=e=>{var a,l,u,k,n;if(!e)return[];const o=K(j()),t=[];if((a=e.food)!=null&&a.length||t.push({level:"danger",icon:"i-tabler-dog-bowl",text:`${e.name} n'a plus de croquettes`}),e.food){const p=e.food.find(c=>c.state==="stock"),g=e.food.find(c=>c.state==="open");!p&&g&&((l=H(g))==null?void 0:l.percentage)>=90?t.push({level:"warning",icon:"i-tabler-dog-bowl",text:`${e.name} n'a bientôt plus de croquettes`}):!p&&g&&((u=H(g))==null?void 0:u.percentage)>=70&&((k=H(g))==null?void 0:k.percentage)<90&&t.push({level:"info",icon:"i-tabler-dog-bowl",text:`Pensez a prévoire des croquettes pour ${e.name}`})}if(e.weight||t.push({level:"danger",icon:"i-healthicons-weight-outline",text:`${e.name} n'a pas de poids renseigné`}),(n=e.weightHistory)!=null&&n.length)try{const p=[...e.weightHistory].map(c=>({...c,parsedDate:typeof c.date=="string"?E(c.date):c.date})).sort((c,I)=>!c.parsedDate||!I.parsedDate?0:c.parsedDate.compare(I.parsedDate)>0?1:-1),g=p[p.length-1];if(g&&g.parsedDate){const c=o.compare(g.parsedDate);c>=365?t.push({level:"danger",icon:"i-healthicons-weight-outline",text:`${e.name} n'a pas de poids renseigné depuis plus de 1 an`}):c>=187?t.push({level:"warning",icon:"i-healthicons-weight-outline",text:`${e.name} n'a pas de poids renseigné depuis plus de 6 mois`}):c>=60&&t.push({level:"info",icon:"i-healthicons-weight-outline",text:`${e.name} n'a pas de poids renseigné depuis plus de 2 mois`})}}catch(p){console.error("Error processing weight history:",p)}try{!e.fleaProtection||!e.fleaProtection.start||!e.fleaProtection.end||E(e.fleaProtection.end).compare(o)<=0?t.push({level:"danger",icon:"i-heroicons-bug-ant",text:`${e.name} n'est plus protégé contre les puces et les tiques`}):E(e.fleaProtection.end).compare(o.add({days:7}))<=0&&t.push({level:"warning",icon:"i-heroicons-bug-ant",text:`${e.name} ne sera bientôt plus protégé contre les puces et les tiques`})}catch(p){console.error("Error processing flea protection:",p)}try{!e.wormProtection||!e.wormProtection.start||!e.wormProtection.end||E(e.wormProtection.end).compare(o)<=0?t.push({level:"danger",icon:"i-fluent-emoji-high-contrast-worm",text:`${e.name} n'est plus vermifugé`}):E(e.wormProtection.end).compare(o.add({days:7}))<=0&&t.push({level:"warning",icon:"i-fluent-emoji-high-contrast-worm",text:`${e.name} ne sera bientôt plus vermifugé`})}catch(p){console.error("Error processing worm protection:",p)}return t};return(e,o)=>{const t=xe,a=ye,l=we,u=We,k=Oe;return f(),T("div",Ve,[d("div",qe,[o[6]||(o[6]=d("div",{class:"mb-8 text-center"},[d("h1",{class:"text-3xl font-bold dark:text-neutral-50 text-neutral-800 mb-2"},"Mes Compagnons"),d("p",{class:"dark:text-neutral-400 text-neutral-500"},"Gérez vos amis à quatre pattes")],-1)),r(m).loading?(f(),T("div",Ge,[h(t,{name:"i-heroicons-arrow-path",class:"animate-spin text-blue-500 text-2xl"}),o[0]||(o[0]=d("p",{class:"mt-2 text-slate-600"},"Chargement de vos animaux...",-1))])):r(m).error?(f(),T("div",Je,[d("div",Qe,[h(t,{name:"i-heroicons-exclamation-circle",class:"text-red-500 mr-2"}),d("p",null,"Erreur: "+z(r(m).error),1)]),h(a,{class:"mt-2",size:"sm",color:"red",variant:"soft",onClick:s},{default:v(()=>o[1]||(o[1]=[L(" Réessayer ")])),_:1})])):(f(),T("div",Xe,[h(a,{variant:"link",to:"nouveau",class:"group h-full"},{default:v(()=>[d("div",Ye,[h(l,{icon:"i-heroicons-plus",class:"ring-3 ring-neutral-200 dark:ring-neutral-300 bg-neutral-50/30 dark:bg-neutral-950/30 backdrop-blur-sm my-12 md:my-0",ui:{root:"size-24",icon:"size-12"}})])]),_:1}),(f(!0),T(U,null,M(r(m).animals,n=>(f(),P(a,{key:n.name,to:n.name,variant:"link",class:"group h-full"},{default:v(()=>{var p;return[d("div",Ze,[d("div",et,[h(l,{src:n.avatarDisplay,icon:"i-fluent-animal-dog-16-regular",alt:n.name,class:"ring-3 ring-neutral-200 dark:ring-neutral-300 bg-neutral-50/30 dark:bg-neutral-950/30 backdrop-blur-sm",ui:{root:"size-24",icon:"size-12"}},null,8,["src","alt"])]),d("div",tt,[d("div",ot,[d("div",null,[d("div",st,[d("h3",nt,z(n.name),1),h(t,{name:n.gender==="male"?"i-ic-baseline-male":"i-ic-baseline-female",class:F([n.gender==="male"?"text-blue-500":"text-pink-500"])},null,8,["name","class"])]),d("div",rt,[d("span",at,[h(t,{name:"i-heroicons-calendar",class:"mr-1 text-neutral-400 dark:text-neutral-200",size:"sm"}),L(" "+z(i(y(n.birthDate))),1)]),d("span",it,[h(t,{name:"i-heroicons-scale",class:"mr-1 text-neutral-400 dark:text-neutral-200",size:"sm"}),L(" "+z(n.weight)+" kg ",1)])])]),_(n).length?(f(),T("div",lt,[(f(!0),T(U,null,M(_(n),(g,c)=>(f(),P(k,{key:`${n.name}-alert-${c}`,color:g.level==="danger"?"error":g.level==="warning"?"warning":"info",variant:"subtle",class:"cursor-help"},{default:v(()=>[h(u,{text:g.text},{default:v(()=>[d("div",dt,[h(t,{name:g.icon??"i-heroicons-exclamation-triangle",class:"mr-1",size:"sm"},null,8,["name"]),d("span",ct,z(g.level==="danger"?"Urgent":g.level==="warning"?"Attention":"Info"),1)])]),_:2},1032,["text"])]),_:2},1032,["color"]))),128))])):A("",!0)]),d("div",ut,[d("div",pt,[h(t,{name:"i-heroicons-bug-ant",size:"sm",class:F([!n.fleaProtection||!n.fleaProtection.end||C(n.fleaProtection)?"text-red-500":"text-green-500"])},null,8,["class"]),o[2]||(o[2]=d("span",{class:"text-xs text-neutral-600 dark:text-neutral-400"},"Protection anti-puces",-1))]),d("div",ft,[h(t,{name:"i-fluent-emoji-high-contrast-worm",size:"sm",class:F([!n.wormProtection||!n.wormProtection.end||C(n.wormProtection)?"text-red-500":"text-green-500"])},null,8,["class"]),o[3]||(o[3]=d("span",{class:"text-xs text-neutral-600 dark:text-neutral-400"},"Vermifuge",-1))]),d("div",gt,[h(t,{name:"i-tabler-dog-bowl",size:"sm",class:F([(p=n.food)!=null&&p.length?b(n)==="low"?"text-amber-500":"text-green-500":"text-red-500"])},null,8,["class"]),o[4]||(o[4]=d("span",{class:"text-xs text-neutral-600 dark:text-neutral-400"},"Nourriture",-1))]),d("div",mt,[h(t,{name:"i-healthicons-weight-outline",size:"sm",class:F([n.weight?w(n)?"text-green-500":"text-amber-500":"text-red-500"])},null,8,["class"]),o[5]||(o[5]=d("span",{class:"text-xs text-neutral-600 dark:text-neutral-400"},"Poids",-1))])])])])]}),_:2},1032,["to"]))),128))]))])])}}});export{Pt as default};
